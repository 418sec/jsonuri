!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.jsonuri={})}(this,function(e){"use strict";function r(){}function c(e){return"string"==typeof e}function t(e){return Number.isInteger(e)}function p(e){return t(e)&&0<=e}function u(e){return n.test(e)}function s(e){var r=typeof e;return null!=e&&("object"===r||"function"===r)}function l(e){console.error(e)}function a(e,r,n){if(E(e)){if("length"===r){if(!p(n))throw new Error("value: "+n+" "+f);return n>e.length&&(e.length=n),void e.splice(n)}var t=+r;p(t)?(e.length=Math.max(e.length,t),e.splice(t,1,n)):l("key: "+r+" "+f)}else e[r]=n}function h(e,r){if(E(e)){var n=+r;if(!p(n))return;e.splice(n,1)}else delete e[r]}function d(e,r,n,t){if(void 0===t&&(t="after"),r<0||r>e.length)throw new Error(j);switch(t){case"before":r-=1;break;case"append":l("TODO")}e.splice(r,0,n)}function v(e){var r,n,t=e.path||"";for(e.keys?t||(r=e.keys):r=e.path.split("/"),r=r.filter(Boolean);~r.indexOf("");)n=r.indexOf(""),r.splice(n,1);for(;~r.indexOf(".");)n=r.indexOf("."),r.splice(n,1);for(;~r.indexOf("..");)n=r.indexOf(".."),r[n]=r[n-1]="",delete r[n],delete r[n-1],r.splice(n,1),r.splice(n-1,1);return{keys:r,path:r.join("/")}}function y(e,r){var n,t,i,o;if(r+="",!e)return l(x);if(""===r)return e;if(!u(r))return e[r];if(!(t=v({path:r}).keys).length)return e;for(i=t.length,o=0;o<i&&null!=(n=(n||e)[t[o]]);++o);return n}function k(e,r,n){var t,i,o,f;if(r+="",!e||!r)return l(x);if(!u(r))return a(e,r,n);for(i=0,o=(t=v({path:r}).keys).length;i<o;i++)null==e[f=t[i]]&&(e[f]={}),i===o-1?a(e,f,n):e=e[f]}function w(e,r){var n;r+="",e&&r&&(u(r)?(n=y(e,r+"/.."))&&h(n,v({path:r}).keys.pop()||""):h(e,r))}function b(e,r,n,t){var i,o,f;if(r+="",!e)return l(x);if(!t)throw new Error(O);if(i=y(e,r+"/.."),!E(i))throw new Error("insert node "+m);f=o=+v({path:r}).keys.pop(),"after"===t?f=o+1:"before"===t&&(f=o),d(i,f,n)}function g(){var e,r=[];for(e=0;e<arguments.length;e++)r[e]=arguments[e];return v({keys:_.concat.apply(_,r).join("/").split("/")}).path}function i(e,r,n,t){var i,o,f,u,a;return void 0===t&&(t=1),r+="",p(t)&&0<t&&e?(i=y(e,r+"/.."),E(i)?(o=i.length,void(!p(f=+v({path:r}).keys.pop())||o-1<f||((u=f+n*t)<=0&&(u=0),o-1<u&&(u=o-1),a=i[f],h(i,f),d(i,u,a)))):l(m)):l(x)}function o(e,r){var n,t;if(void 0===r&&(r=[]),!s(e))return!1;for(n in r.push(e),e)if(s(t=e[n])&&(~r.indexOf(t)||o(t,r.slice())))return!0;return!1}var f="is not a natural number",m="must be a Array",x="the parameter is illegal",O="direction must be 'before' | 'after' | 'append'",j="the Index Out of Bounds",E=Array.isArray,n=/\//,_=Array.prototype;e.get=y,e.set=k,e.rm=w,e.swap=function(e,r,n){var t,i;if(r+="",n+="",!(e&&r&&n&&c(r)&&c(n)))return l(x);t=y(e,r),i=y(e,n),k(e,n,t),k(e,r,i)},e.mv=function(e,r,n,t){var i,o,f,u,a,p;if(r+="",n+="",!(e&&r&&n&&c(r)&&c(n)))return l(x);if(r!==n){if(i=y(e,n),o=y(e,r),f=y(e,n+"/.."),u=+(v({path:r}).keys.pop()||""),a=+(v({path:n}).keys.pop()||""),E(f)){if(!t)throw new Error(O);return p=g(r+"/..")===g(n+"/.."),b(e,n,o,t),p?void h(f,u+(u<a?0:1)):void w(e,r)}if(!s(i))throw new Error("'"+n+"': "+i+" is primitive values");k(e,n+"/"+r,o),w(e,r)}},e.insert=b,e.up=function(e,r,n){i(e,r,-1,n)},e.down=function(e,r,n){i(e,r,1,n)},e.walk=function(e,a,p){if(void 0===e&&(e={}),void 0===a&&(a=r),void 0===p&&(p=r),o(e))throw new Error("obj is a circular structure");var c=[];return function u(e){return function(e,r){function n(){f=!0}var t,i,o,f=!1;for(t=0,i=Object.keys(e);t<i.length&&(o=i[t],!f);t++)r(e[o],o,e,{_break:n})}(e,function(e,r,n,t){function i(){o(),f=!0,E(n)&&c.pop()}var o=t._break,f=!1;if(c.push(r),a(e,r,n,{path:g(c),_break:i}),c.pop(),s(e)){if(c.push(r),f)return;u(e),c.pop(),p(e,r,n,{path:g(c),_break:i})}}),e}(e)},e.normalizePath=g,e._computePath=function(e,r){var n=+v({path:e}).keys.pop();return t(n)?"prev"===r?g(e,"..",n-1):"next"===r?g(e,"..",n+1):null:null},e.isCircular=o,Object.defineProperty(e,"__esModule",{value:!0})});