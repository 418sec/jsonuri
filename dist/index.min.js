!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).jsonuri={})}(this,function(e){"use strict";function r(){}function c(e){return"string"==typeof e}function t(e){return Number.isInteger(e)}function p(e){return t(e)&&0<=e}function u(e){return n.test(e)}function s(e){var r=typeof e;return null!=e&&("object"===r||"function"===r)}function l(e){return e+""}function h(e){console.error(e)}function a(e,r,n){if(_(e)){if("length"===r){if(!p(n))throw new Error("value: "+n+" "+f);return n>e.length&&(e.length=n),void e.splice(n)}var t=+r;p(t)?(e.length=Math.max(e.length,t),e.splice(t,1,n)):h("key: "+r+" "+f)}else e[r]=n}function d(e,r){if(_(e)){var n=+r;if(!p(n))return;e.splice(n,1)}else delete e[r]}function v(e,r,n,t){if(void 0===t&&(t="after"),r<0||r>e.length)throw new Error(E);switch(t){case"before":r-=1;break;case"append":h("TODO")}e.splice(r,0,n)}function y(e){var r,n,t=e.path||"";for(e.keys?t||(r=e.keys):r=e.path.split("/"),r=r.filter(Boolean);~r.indexOf("");)n=r.indexOf(""),r.splice(n,1);for(;~r.indexOf(".");)n=r.indexOf("."),r.splice(n,1);for(;~r.indexOf("..");)n=r.indexOf(".."),r[n]=r[n-1]="",delete r[n],delete r[n-1],r.splice(n,1),r.splice(n-1,1);return{keys:r,path:r.join("/")}}function k(e,r){var n,t,i,o;if(r=l(r),!e)return h(O),e;if(""===r)return e;if(!u(r))return e[r];if(!(t=y({path:r}).keys).length)return e;for(i=t.length,o=0;o<i&&null!=(n=(o?n:e)[t[o]]);++o);return n}function w(e,r,n){var t,i,o,f;if(r=l(r),!e||!r)return h(O);if(!u(r))return a(e,r,n);for(i=0,o=(t=y({path:r}).keys).length;i<o;i++)null==e[f=t[i]]&&(e[f]={}),i===o-1?a(e,f,n):e=e[f]}function b(e,r){var n;r=l(r),e&&r&&(u(r)?(n=k(e,r+"/.."))&&d(n,y({path:r}).keys.pop()||""):d(e,r))}function g(e,r,n,t){var i,o,f;if(r=l(r),!e)return h(O);if(!t)throw new Error(j);if(i=k(e,r+"/.."),!_(i))throw new Error("insert node "+x);f=o=+y({path:r}).keys.pop(),"after"===t?f=o+1:"before"===t&&(f=o),v(i,f,n)}function m(){var e,r=[];for(e=0;e<arguments.length;e++)r[e]=arguments[e];return y({keys:A.concat.apply(A,r).join("/").split("/")}).path}function i(e,r,n,t){var i,o,f,u,a;return void 0===t&&(t=1),r=l(r),p(t)&&0<t&&e?(i=k(e,r+"/.."),_(i)?(o=i.length,void(!p(f=+y({path:r}).keys.pop())||o-1<f||((u=f+n*t)<=0&&(u=0),o-1<u&&(u=o-1),a=i[f],d(i,f),v(i,u,a)))):h(x)):h(O)}function o(e,r){var n,t;if(void 0===r&&(r=[]),!s(e))return!1;for(n in r.push(e),e)if(s(t=e[n])&&(~r.indexOf(t)||o(t,r.slice())))return!0;return!1}var f="is not a natural number",x="must be a Array",O="the parameter is illegal",j="direction must be 'before' | 'after' | 'append'",E="the Index Out of Bounds",_=Array.isArray,n=/\//,A=Array.prototype;e.get=k,e.set=w,e.rm=b,e.swap=function(e,r,n){var t,i;if(r=l(r),n=l(n),!(e&&r&&n&&c(r)&&c(n)))return h(O);t=k(e,r),i=k(e,n),w(e,n,t),w(e,r,i)},e.mv=function(e,r,n,t){var i,o,f,u,a,p;if(r=l(r),n=l(n),!(e&&r&&n&&c(r)&&c(n)))return h(O);if(r!==n){if(i=k(e,n),o=k(e,r),f=k(e,n+"/.."),u=+(y({path:r}).keys.pop()||""),a=+(y({path:n}).keys.pop()||""),_(f)){if(!t)throw new Error(j);return p=m(r+"/..")===m(n+"/.."),g(e,n,o,t),p?void d(f,u+(u<a?0:1)):void b(e,r)}if(!s(i))throw new Error("'"+n+"': "+i+" is primitive values");w(e,n+"/"+r,o),b(e,r)}},e.insert=g,e.up=function(e,r,n){i(e,r,-1,n)},e.down=function(e,r,n){i(e,r,1,n)},e.walk=function(e,a,p){if(void 0===e&&(e={}),void 0===a&&(a=r),void 0===p&&(p=r),o(e))throw new Error("obj is a circular structure");var c=[];return function u(e){return function(e,r){function n(){f=!0}var t,i,o,f=!1;for(t=0,i=Object.keys(e);t<i.length&&(o=i[t],!f);t++)r(e[o],o,e,{_break:n})}(e,function(e,r,n,t){function i(){o(),f=!0,_(n)&&c.pop()}var o=t._break,f=!1;if(c.push(r),a(e,r,n,{path:m(c),_break:i}),c.pop(),s(e)){if(c.push(r),f)return;u(e),c.pop(),p(e,r,n,{path:m(c),_break:i})}}),e}(e)},e.normalizePath=m,e._computePath=function(e,r){var n=+y({path:e}).keys.pop();return t(n)?"prev"===r?m(e,"..",n-1):"next"===r?m(e,"..",n+1):null:null},e.isCircular=o,Object.defineProperty(e,"__esModule",{value:!0})});